import{a as Ge}from"./chunk-VDV5FSQN.js";import{a as C,b as Ie,c as Ae,d as ke,e as Ne,f as Ve,g as Le,h as qe,i as je,j as Re,k as Be}from"./chunk-XKWGZWOJ.js";import{a as ye}from"./chunk-QXSUWR23.js";import{c as Se,e as Me,f as Ee,g as K}from"./chunk-QXQ3G5IP.js";import{a as _}from"./chunk-5NBA5GWV.js";import"./chunk-BYXBJQAS.js";import{a as He}from"./chunk-U5ZU6LZ4.js";import{c as se,e as O,f as T}from"./chunk-XMX2U4D6.js";import{B as y,D as xe,E as Oe,F as we,O as Te,R as Fe,S as De,b as pe,e as ce,f as ue,g as de,h as he,i as be,j as fe,k as ge,l as _e,n as Ce,p as w,q as ve,s as F,t as Pe,u as D,v as Q,y as v}from"./chunk-BUQZUOJ6.js";import{c as ne,k as le,m as me,o as J}from"./chunk-EHWZVOTM.js";import"./chunk-CARY4E7O.js";import{E as R,Ea as G,I as B,Ib as r,Jb as n,Kb as $,N as H,Ob as g,Rb as s,Tb as u,Xb as X,Yb as ee,Yc as x,Zb as te,Zc as oe,ad as re,bc as l,ca as Y,cc as U,da as P,db as m,dc as E,eb as p,ha as Z,mc as z,na as S,nc as ae,oa as M,oc as ie,v as j,vb as f,wa as h,xa as b,zb as c}from"./chunk-QE3WHX6I.js";var I=class{id_empresa=0;id_evento=0;id=0;arquivo="";pagina=0;tamPagina=50;contador="N";orderby="";sharp=!1};function $e(i,e){try{let t=0;return t=parseInt(Object(e).id,10),isNaN(t)?i.id=0:i.id=t,Object(e).arquivo?.trim()!==""&&(i.arquivo=Object(e).arquivo),Object(e).orderby?.trim()!==""&&(i.orderby=Object(e).orderby),i}catch(t){throw t}}var A=class i{constructor(e){this.http=e}apiURL=se.apiURL;getCabplanilhas(){return this.http.get(`${this.apiURL}Cabplanilhas`)}getCabplanilhasParametro_01(e){return this.http.post(`${this.apiURL}cabplanilhas`,e)}getCabplanilha(e,t,a){return this.http.get(`${this.apiURL}cabplanilha/${e}/${t}/${a}`)}cabplanilhaInsert(e){return this.http.post(`${this.apiURL}cabplanilha`,e)}cabplanilhaUpdate(e){return this.http.put(`${this.apiURL}cabplanilha`,e)}cabplanilhaDelete(e,t,a){return this.http.delete(`${this.apiURL}cabplanilha/${e}/${t}/${a}`)}static \u0275fac=function(t){return new(t||i)(Z(ne))};static \u0275prov=Y({token:i,factory:i.\u0275fac,providedIn:"root"})};function it(i,e){if(i&1){let t=g();r(0,"mat-icon",9),s("click",function(){h(t);let o=u();return b(o.onGetExcelToEmailOrDownLoad("e-mail"))}),l(1,"mail"),n()}}function ot(i,e){if(i&1){let t=g();r(0,"mat-icon",10),s("click",function(){h(t);let o=u();return b(o.onGetExcelToEmailOrDownLoad("download"))}),l(1,"cloud_download"),n()}}function rt(i,e){if(i&1&&(r(0,"mat-option",22),l(1),n()),i&2){let t=e.$implicit;c("value",t.sigla),m(),E(" ",t.descricao," ")}}function nt(i,e){if(i&1){let t=g();r(0,"button",23),s("click",function(){h(t);let o=u(2);return b(o.clearValue("id"))}),r(1,"mat-icon"),l(2,"close"),n()()}}function lt(i,e){if(i&1){let t=g();r(0,"button",23),s("click",function(){h(t);let o=u(2);return b(o.clearValue("arquivo"))}),r(1,"mat-icon"),l(2,"close"),n()()}}function mt(i,e){if(i&1){let t=g();r(0,"form",11)(1,"div",12)(2,"mat-form-field",13)(3,"mat-label"),l(4,"Ordernado Por"),n(),r(5,"mat-select",14),s("selectionChange",function(){h(t);let o=u();return b(o.onChangeParametros())}),f(6,rt,2,2,"mat-option",15),n()(),r(7,"mat-form-field",16)(8,"mat-label"),l(9,"C\xF3digo"),n(),$(10,"input",17),f(11,nt,3,0,"button",18),n()(),r(12,"div",19)(13,"mat-form-field",20)(14,"mat-label"),l(15,"Arquivo"),n(),$(16,"input",21),f(17,lt,3,0,"button",18),n()()()}if(i&2){let t=u();c("formGroup",t.formulario),m(6),c("ngForOf",t.orderby),m(5),c("ngIf",t.hasValue("id")),m(6),c("ngIf",t.hasValue("arquivo"))}}var N=class i{constructor(e,t,a,o,d,q,W){this.formBuilder=e;this.globalService=t;this.parametrosService=a;this.emailService=o;this.appSnackBar=d;this.EmailDialog=q;this.DownLoadDialog=W;this.formulario=e.group({orderby:[{value:""}],id:[{value:""}],arquivo:[{value:""}]}),this.setHide(),this.setValuesNoParam()}paramName="";retorno=!1;email=!1;download=!1;controle_paginas=new _(50,0);hide=!0;change=new G;changeHide=new G;inscricaoParametro;inscricaoEmail;formulario;showFiltro=!0;hideAcao="Ocultar";orderby=[{sigla:"000000",descricao:"C\xF3digo"},{sigla:"000001",descricao:"Arquivo"}];parametro=new C;enable_filter=!1;valueChangeSubs=[];ngOnInit(){this.loadParametros()}setEnableFilter(e){if(this.enable_filter=e,!e){this.valueChangeSubs.forEach(o=>o.unsubscribe()),this.valueChangeSubs=[];return}let t=this.formulario.get("id")?.valueChanges.pipe(j(o=>o?.trim()),R(o=>o?.length>0),B(350),H()).subscribe(()=>this.onChangeParametros()),a=this.formulario.get("arquivo")?.valueChanges.pipe(j(o=>o?.trim()),R(o=>o?.length>0),B(350),H()).subscribe(()=>this.onChangeParametros());this.valueChangeSubs=[t,a].filter(o=>!!o)}ngOnDestroy(){this.inscricaoParametro?.unsubscribe(),this.inscricaoEmail?.unsubscribe()}onGetExcelToEmailOrDownLoad(e){e.toUpperCase()=="E-MAIL"?this.openEmailDialog():this.openDownLoadDialog()}sendMail(e){let t=new Ve;t.id_empresa=this.globalService.getEmpresa().id,t.id_evento=1,t.assunto="Relat\xF3rio Dos Ativos Do Invent\xE1rio",t.destinatario=this.globalService.usuario.email,t.mensagem="Mensagem enviada automaticamento por solicita\xE7\xE3o do usu\xE1rio. Favor Verificar Anexo.",t.fileName=e,this.globalService.setSpin(!0),this.inscricaoEmail=this.emailService.sendEmailV2(t).subscribe({next:a=>{this.appSnackBar.openSuccessSnackBar("E-Mail Enviado Com Sucesso!","OK")},error:a=>{this.appSnackBar.openFailureSnackBar("Falha Ao Enviar O E-Mail","OK")}})}setValues(){let e=this.parametro.getParametro();this.formulario.setValue({orderby:K(this.parametro.getParametro(),"orderby"),id:Ee(this.parametro.getParametro(),"id"),arquivo:K(this.parametro.getParametro(),"arquivo")})}setValuesNoParam(){this.formulario.setValue({orderby:"",id:"",arquivo:""})}setHide(){this.hide=!this.hide,this.hideAcao=this.hide?"Mostrar":"Ocultar"}onlimparParametros(){this.parametro=this.InicializaParametro(),this.setEnableFilter(!1),this.setValues(),this.setEnableFilter(!0),this.onChangeParametros()}InicializaParametro(){let e=new C;return e.id_empresa=this.globalService.getEmpresa().id,e.modulo=this.paramName,e.assinatura="V1.00 06/11/2025",e.id_usuario=this.globalService.getUsuario().id,e.parametro=`
         {
            "id":"",
            "arquivo":"",
            "orderby":"000001",
            "page":1,
            "sharp":false
        }`,e}loadParametros(){this.parametro=this.InicializaParametro(),this.getParametro()}getParametro(){this.globalService.setSpin(!0);let e=new ke;e.id_empresa=this.parametro.id_empresa,e.modulo=this.parametro.modulo,e.assinatura=this.parametro.assinatura,e.id_usuario=this.parametro.id_usuario,this.inscricaoParametro=this.parametrosService.getParametrosParametro_01(e).subscribe({next:t=>{this.parametro=new C,this.parametro.id_empresa=t[0].id_empresa,this.parametro.modulo=t[0].modulo,this.parametro.id_usuario=t[0].id_usuario,this.parametro.assinatura=t[0].assinatura,this.parametro.parametro=t[0].parametro,this.parametro.user_insert=t[0].user_insert,this.parametro.user_update=t[0].user_update,this.setValues(),this.setEnableFilter(!0),this.onChangeParametros()},error:t=>{this.setValues(),this.setEnableFilter(!0),this.onChangeParametros()}})}updateParametros(){console.log("Salvando Par\xE2metros...",this.parametro.getParametro()),this.parametro.user_insert=this.globalService.usuario.id,this.parametro.user_update=this.globalService.usuario.id,this.refreshParametro(),this.inscricaoParametro=this.parametrosService.ParametroAtualiza(this.parametro).subscribe({next:e=>{this.appSnackBar.openSuccessSnackBar("Par\xE2metros Salvos Com Sucesso!","OK")},error:e=>{this.appSnackBar.openFailureSnackBar(`Falha Ao Salvar Os Par\xE2metros! ${Me(e)}`,"OK")}})}refreshParametro(){let e=this.parametro.getParametro();Object(e).orderby=this.formulario.value.orderby,Object(e).id=this.formulario.value.id,Object(e).arquivo=this.formulario.value.arquivo.toUpperCase(),this.parametro.parametro=JSON.stringify(e)}onChangeParametros(){this.enable_filter&&(this.refreshParametro(),this.change.emit(this.parametro))}onSaveConfig(){this.updateParametros()}onHide(){this.setHide(),this.changeHide.emit(this.hide)}hasValue(e){return this.formulario.get(e)?.value!=""}clearValue(e){e=="id"&&this.formulario.patchValue({id:""}),e=="arquivo"&&this.formulario.patchValue({arquivo:""}),this.onChangeParametros()}ChangeValue(e,t){e=="id"&&this.formulario.patchValue({id:t}),e=="arquivo"&&this.formulario.patchValue({arquivo:t})}openEmailDialog(){let e=new Ne;e.titulo="ENVIAR CONSULTA VIA E-MAIL",e.destinatario=this.globalService.usuario.email,e.escopo="T",e.labelBottomNao="Cancelar",e.labelBottonSim="Processar",e.id_empresa=this.globalService.empresa.id,e.pagina=this.controle_paginas.getPaginalAtual(),e.parametro=this.parametro;let t=new Q;t.disableClose=!0,t.id="consulta-email",t.width="800px",t.data=e;let a=this.EmailDialog.open(qe,t).beforeClosed().subscribe(o=>{})}openDownLoadDialog(){console.log("Pagina: ",this.controle_paginas.getPaginalAtual());let e=new je;e.titulo="DOWNLOAD DE CONSULTA",e.escopo="T",e.labelBottomNao="Cancelar",e.labelBottonSim="Processar",e.id_empresa=this.globalService.empresa.id,e.id_evento=1,e.pagina=this.controle_paginas.getPaginalAtual(),e.parametro=this.parametro;let t=new Q;t.disableClose=!0,t.id="consulta-download",t.width="800px",t.data=e;let a=this.DownLoadDialog.open(Re,t).beforeClosed().subscribe(o=>{})}NoValidtouchedOrDirty(e){return!!(!this.formulario.get(e)?.valid&&(this.formulario.get(e)?.touched||this.formulario.get(e)?.dirty))}getMensafield(e){return this.formulario.get(e)?.errors?.message}static \u0275fac=function(t){return new(t||i)(p(fe),p(O),p(Be),p(Le),p(T),p(v),p(v))};static \u0275cmp=S({type:i,selectors:[["app-formulario-filtro-cabplanilha"]],inputs:{paramName:[0,"PARAMNAME","paramName"],retorno:[0,"RETORNO","retorno"],email:[0,"EMAIL","email"],download:[0,"DOWNLOAD","download"],controle_paginas:[0,"CONTROLE_PAGINAS","controle_paginas"],hide:[0,"HIDE","hide"]},outputs:{change:"changeParametro",changeHide:"changeHide"},decls:13,vars:3,consts:[["color","white",1,"toolbar-filtro"],[1,"filtro-com-icones"],[1,"titulo"],["matTooltipPosition","above","matTooltip","Limpar Par\xE2metros","matTooltipPosition","above",3,"click"],["matTooltipPosition","above","matTooltip","Salvar Par\xE2metros","matTooltipPosition","above",3,"click"],["matTooltipPosition","above","matTooltip","Enviar Consulta Por E-Mail","matTooltipPosition","above",3,"click",4,"ngIf"],["matTooltipPosition","above","matTooltip","Baixar A Consulta","matTooltipPosition","above",3,"click",4,"ngIf"],["matTooltipPosition","above","matTooltip","Mostrar/Esconder","matTooltipPosition","above",3,"click"],["autocomplete","off",3,"formGroup",4,"ngIf"],["matTooltipPosition","above","matTooltip","Enviar Consulta Por E-Mail","matTooltipPosition","above",3,"click"],["matTooltipPosition","above","matTooltip","Baixar A Consulta","matTooltipPosition","above",3,"click"],["autocomplete","off",3,"formGroup"],[1,"col-med-2"],["field","","appearance","outline",1,"col-max"],["formControlName","orderby",3,"selectionChange"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline",1,"col-max"],["matInput","","formControlName","id"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click",4,"ngIf"],[1,"col-med-1"],["appearance","outline",1,"uppercase-input","column-span-2"],["matInput","","formControlName","arquivo"],[3,"value"],["matSuffix","","mat-icon-button","","aria-label","Clear",3,"click"]],template:function(t,a){t&1&&(r(0,"div",0)(1,"span",1)(2,"span",2),l(3,"Filtro da Pesquisa"),n(),r(4,"mat-icon",3),s("click",function(){return a.onlimparParametros()}),l(5,"clear"),n(),r(6,"mat-icon",4),s("click",function(){return a.onSaveConfig()}),l(7,"save"),n(),f(8,it,2,0,"mat-icon",5)(9,ot,2,0,"mat-icon",6),r(10,"mat-icon",7),s("click",function(){return a.onHide()}),l(11,"visibility"),n()()(),f(12,mt,18,4,"form",8)),t&2&&(m(8),c("ngIf",a.email),m(),c("ngIf",a.download),m(3),c("ngIf",!a.hide))},dependencies:[x,oe,Ce,w,F,we,Oe,y,xe,Te,D,de,pe,ce,ue,he,be],styles:[".grupo-select[_ngcontent-%COMP%]   .clear-button[_ngcontent-%COMP%]{margin-top:4px;padding:0;height:24px;width:24px;line-height:24px;vertical-align:middle;transform:translateY(1px)}"]})};function pt(i,e){if(i&1){let t=g();r(0,"tr")(1,"td")(2,"div",10)(3,"mat-label",11),l(4),z(5,"zeroFill"),n()()(),r(6,"td")(7,"div")(8,"mat-label",12),l(9),z(10,"truncate"),n()(),r(11,"div")(12,"mat-label",11),l(13),n()()(),r(14,"td",13)(15,"barra-acoes",14),s("changeOpcao",function(o){let d=h(t),q=d.$implicit,W=d.index,ze=u();return b(ze.escolha(o,W,q))}),n()()()}if(i&2){let t=e.$implicit;m(4),E("",ae(5,4,t.id)," "),m(4),c("matTooltip",t.arquivo),m(),U(ie(10,6,t.arquivo,50)),m(4),U(t.arquivo)}}var V=class i{constructor(e,t,a,o,d,q){this.globalService=e;this.cabplanilhaService=t;this.route=a;this.router=o;this.appSnackBar=d;this.cabPlanilhaDialog=q}viewPort;inscricaoCabec;cabPlanilhas=[];controlePaginas=new _(0,0);tamPagina=50;retorno=!1;parametro=new C;hide=!1;ngOnInit(){}ngOnDestroy(){this.inscricaoCabec?.unsubscribe()}escolha(e,t,a){}onHome(){this.router.navigate([""])}getAcoes(){return ye}getCabPlanilhas(e=2){let t=new I;t=$e(t,this.parametro.getParametro()),e==1?t.contador="S":(t.pagina=this.controlePaginas.getPaginalAtual(),t.tamPagina=this.controlePaginas.getTamPagina()),this.inscricaoCabec=this.cabplanilhaService.getCabplanilhasParametro_01(t).subscribe({next:a=>{e==2?this.cabPlanilhas=a:(this.controlePaginas=new _(this.tamPagina,a.total==0?1:a.total),this.getCabPlanilhas())},error:a=>{console.log(a),this.cabPlanilhas=[],this.controlePaginas=new _(this.tamPagina,0)}})}getTexto(){return Se}onChangePage(){this.getCabPlanilhas()}onChangeHide(e){this.hide=e}onChangeParametros(e){this.parametro=e,console.log("Paramentro de Pesquisa",this.parametro),this.getCabPlanilhas(1)}static \u0275fac=function(t){return new(t||i)(p(O),p(A),p(le),p(me),p(T),p(v))};static \u0275cmp=S({type:i,selectors:[["app-crud-planilha"]],viewQuery:function(t,a){if(t&1&&X(ve,5),t&2){let o;ee(o=te())&&(a.viewPort=o.first)}},decls:24,vars:7,consts:[[1,"toolbar-alinhada"],[1,"example-spacer"],[3,"changePage","controle"],["mat-icon-button","","aria-label","Example icon-button with share icon ","matTooltip","Retorno","matTooltipPosition","above",3,"click"],["mat-icon-button","","aria-label","Example icon-button with share icon","matTooltip","Atualizar","matTooltipPosition","above",1,"example-icon",3,"click"],["mat-icon-button","","aria-label","Example icon-button with share icon ","matTooltipPosition","above",3,"click","matTooltip"],["PARAMNAME","cabplanilhas",3,"changeParametro","changeHide","HIDE","EMAIL","DOWNLOAD","CONTROLE_PAGINAS"],[1,"Browse_Lanc"],[1,"coluna-cabec"],[4,"ngFor","ngForOf"],[1,"alinha_centro"],[1,"Browse_Lanc_td"],["matTooltipPosition","above",1,"Browse_Lanc_td",3,"matTooltip"],[1,"acoes"],[3,"changeOpcao"]],template:function(t,a){t&1&&(r(0,"div",0)(1,"mat-toolbar")(2,"span",1),l(3,"PLanilhas De Importa\xE7\xE3o: "),n(),r(4,"app-navegator",2),s("changePage",function(){return a.onChangePage()}),n(),r(5,"button",3),s("click",function(){return a.onHome()}),r(6,"mat-icon"),l(7,"home"),n()(),r(8,"button",4),s("click",function(){return a.getCabPlanilhas()}),r(9,"mat-icon"),l(10,"rotate_right"),n()(),r(11,"button",5),s("click",function(){return a.escolha(a.getAcoes().Inclusao,-1)}),r(12,"mat-icon"),l(13,"add_circle_outline"),n()()()(),r(14,"app-formulario-filtro-cabplanilha",6),s("changeParametro",function(d){return a.onChangeParametros(d)})("changeHide",function(d){return a.onChangeHide(d)}),n(),r(15,"table",7)(16,"tr",8)(17,"th"),l(18,"C\xF3digo"),n(),r(19,"th"),l(20,"Arquivo"),n(),r(21,"th"),l(22,"A\xC7\xD5ES"),n()(),f(23,pt,16,9,"tr",9),n()),t&2&&(m(4),c("controle",a.controlePaginas),m(7),c("matTooltip",a.getTexto().incluir),m(3),c("HIDE",a.hide)("EMAIL",!0)("DOWNLOAD",!0)("CONTROLE_PAGINAS",a.controlePaginas),m(9),c("ngForOf",a.cabPlanilhas))},dependencies:[x,w,F,y,Pe,D,Ie,Ae,N,He,Ge],styles:[".form-container[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;margin:20px}.dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:end;align-items:right;padding:1em;border-bottom:1px solid #ccc;background-color:#f5f5f5;position:sticky;top:0;z-index:1}.mat-dialog-container[_ngcontent-%COMP%], .mat-form-field[_ngcontent-%COMP%], .mat-label[_ngcontent-%COMP%], .mat-input-element[_ngcontent-%COMP%], .mat-select-value[_ngcontent-%COMP%], .mat-option[_ngcontent-%COMP%], .mat-error[_ngcontent-%COMP%], .mat-button[_ngcontent-%COMP%], .mat-toolbar[_ngcontent-%COMP%]{font-size:13px}.button-container[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:10px;padding:1em;border-top:1px solid #ccc}"]})};var ct=[{path:"",redirectTo:"planilhas",pathMatch:"full"},{path:"planilhas",component:V}],L=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=M({type:i});static \u0275inj=P({imports:[J.forChild(ct),J]})};var Ue=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=M({type:i});static \u0275inj=P({imports:[re,L,Fe,ge,_e,De]})};export{Ue as PlanilhaModule};
